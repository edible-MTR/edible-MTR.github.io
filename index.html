<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Home - Welcome to Edible</title>
	<!-- Jquery Mobile -->
	<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
	<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script> 
	<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

	<!-- Stylesheets -->
	
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" integrity="sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp" crossorigin="anonymous">
	
	<link rel="stylesheet" href="Edible Theme/themes/Edible.css">
	<link rel="stylesheet" type="text/css" href="css/mediaCss.css">
	<link rel="stylesheet" type="text/css" href="css/favourites.css">
</head>
<body>
	<!-- Home Page --> 
	<div data-role="page" id="home">
		<!-- Portrait or Narrow Viewport Only Class -->
		<section class="landscapeDevice ui-grid-a ui-content " role="main">
			<div class="ui-block-a sideBar ui-body-a" >
				<div class="ui-bar">
					<img class="logo" alt="Edible Logo">
					<div id="edibleBadge">
						<p id="badgeDescriptor">empty</p>
						<div id="badgeTitle" class="clLight">no content</div>
					</div>
				</div>
			</div>
			<div class="ui-block-b contentArea">
				<div class="homeContent">
					<div id="keywordSearch" class="ui-bar">
						<div data-role="controlgroup" data-type="horizontal">
							<input type="text" id="WordSearch" data-wrapper-class="controlgroup-textinput ui-btn ui-btn-a ui-corner-all" name="wordString" placeholder="Keyword Search">
							<button class="">
								<i class="fas fa-search fa-2x"></i>
							</button>
						</div>
					</div>
					<h1 id="welcomeBanner" class="ui-bar ui-bar-c ui-corner-all">
						Welcome to Edible! We bring the homemade goodness to you. You click and we cook!
					</h1>
				</div>
				<header class="pageTitle">
					<h1>Top Dishes</h1>
					<div class="pageTitleHR"></div>
				</header>
				<div class="dishList"> 
					<div class="dishList" class="ui-bar ui-bar-c ui-corner-all">
						<a class="ui-btn" href="https://edible-mtr.github.io/edibleTair.html" target="_blank">
							<i class="fas fa-utensils"></i> Tair's Dish Page
						</a>
					</div>
				</div>
			</div>
		</section>
		<!-- Portrait or Narrow Viewport Only Class -->
		<section class="portraitDevice ui-content" role="main">
			<header class="ui-bar ui-bar-a">
				<img class="logo" alt="Edible Logo">
			</header>
			<div role="main" class="ui-content">
				<div class="homeContent">
					<div id="keywordSearch" class="ui-bar">
						<div data-role="controlgroup" data-type="horizontal">
							<input type="text" id="WordSearch" data-wrapper-class="controlgroup-textinput ui-btn ui-btn-a ui-corner-all" name="wordString" placeholder="Keyword Search">
							<button class="">
								<i class="fas fa-search fa-2x"></i>
							</button>
						</div>
					</div>
					<h1 id="welcomeBanner" class="ui-bar ui-bar-c ui-corner-all">
						Welcome to Edible! We bring the goodness of homemade meals to you. You click and we cook!
					</h1>
				</div>
				<header class="pageTitle">
					<h1>Top Dishes</h1>
					<div class="pageTitleHR"></div>
				</header>
				<div class="dishList"> 
					<div class="dishList" class="ui-bar ui-bar-c ui-corner-all">
						<a class="ui-btn ui-btn-a" href="https://edible-mtr.github.io/edibleTair.html" target="_blank">
							<i class="fas fa-utensils"></i> Tair's Dish Page
						</a>
					</div>
				</div>
			</div>
		</section>
		<footer data-role="navbar">
				<ul>
					<li><a href="#home" class="ui-btn-active"><i class="fas fa-home fa-2x"></i></a></li>
					<li><a href="#filteredSearch"><i class="fas fa-search fa-2x"></i></a></li>
					<li><a href="#checkout"><i class="fas fa-shopping-cart fa-2x"></i></a></li>
					<li><a href="#favourites"><i class="far fa-heart fa-2x"></i></a></li>
					<li><a href="#qrScanner"><i class="fas fa-qrcode fa-2x"></i></a></li>
				</ul>
		</footer>
	</div>
	<!-- Filtered Search Page --> 
	<!-- Checkout Page --> 
	<!-- Favourites Page -->
	<div data-role="page" id="favourites">
		<!-- Portrait or Narrow Viewport Only Class -->
		<section class="landscapeDevice ui-grid-a ui-content " role="main">
			<div class="ui-block-a sideBar ui-body-a" >
				<div class="ui-bar">
					<img class="logo" alt="Edible Logo">
					<div id="edibleBadge">
						<p id="badgeDescriptor">empty</p>
						<div id="badgeTitle" class="clLight">no content</div>
					</div>
				</div>
			</div>
			<div class="ui-block-b contentArea">
				<header class="pageTitle">
					<h1>Favourites</h1>
					<div class="pageTitleHR"></div>
				</header>
				<div class="favDishList"> 
					<div class="favItem" dishId="">
						<div class="favImage" src="./images/v718_3831.png"></div>
						<div class="textCenter">
							<h2 class="favTitle">Spaghetti carbonara</h2>
							<p class="favText">A well–made carbonara is the ultimate crowd–pleaser. It can be a meal for a
								simple Sunday night dinner on the couch yet works just as well as a classy dish to
							pull out...</p>
						</div>
						<h3 class="favCost">£12</h3>
						<div class="rightIcons">
							<div class="favCartBtn"><i class="icon fas fa-shopping-cart fa-2x"></i></div>
							<div class="favRemoveBtn"><i class="icon fas fa-times fa-2x"></i></div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!-- Portrait or Narrow Viewport Only Class -->
		<section class="portraitDevice ui-content" role="main">
			<header class="ui-bar ui-bar-a">
				<img class="logo" alt="Edible Logo">
			</header>
			<div role="main" class="ui-content">
				<header class="pageTitle">
					<h1>Favourites</h1>
					<div class="pageTitleHR"></div>
				</header>
				<div class="favDishList"> 
				</div>
			</div>
		</section>
		<!-- Footer is consistent accross all devices -->
		<footer data-role="navbar">
				<ul>
					<li><a href="#home" ><i class="fas fa-home fa-2x"></i></a></li>
					<li><a href="#filteredSearch"><i class="fas fa-search fa-2x"></i></a></li>
					<li><a href="#checkout"><i class="fas fa-shopping-cart fa-2x"></i></a></li>
					<li><a href="#favourites" class="ui-btn-active"><i class="far fa-heart fa-2x"></i></a></li>
					<li><a href="#qrScanner"><i class="fas fa-qrcode fa-2x"></i></a></li>
				</ul>
		</footer>
	</div>

	<!-- QR Scanner Page --> 
	<script type="text/javascript" src="edibleData.json"></script>
	<script type="text/javascript">
		var idOfFavourites = [];
		function getFavourites() {
			idOfFavourites = []; //Empty array before repopulating
			for(item in data.dishes){ //populate my favourites array with ids of dishes
					if(data.dishes[item].dishFav  == 1){
						idOfFavourites.push(data.dishes[item].id);
					}
				}
			for(id in idOfFavourites){ //create html of the favourites add to list
				innerHtmlString = `<div class="favItem" dishId="` + idOfFavourites[id] +`">
				<img class="favImage" src="`+ data.dishes[idOfFavourites[id]].dishImage +`" alt="Image of " `+ data.dishes[idOfFavourites[id]].dishName+`>
				<div class="textCenter">
				<h2 class="favTitle">`+ data.dishes[idOfFavourites[id]].dishName +`</h2>
				<p class="favText">`+ data.dishes[idOfFavourites[id]].dishDescription.substring(0, 100) +`...</p>
				</div>
				<h3 class="favCost">£`+ data.dishes[idOfFavourites[id]].dishPrice +`</h3>
				<div class="rightIcons">
				<div class="favCartBtn"><i class="icon fas fa-shopping-cart fa-2x"></i></div>
				<div class="favRemoveBtn"><i class="icon fas fa-times fa-2x"></i></div>
				</div>
					</div>`; //string litteral representation of inner div
					$(".favDishList").append(innerHtmlString); //attach the favourites to the dom
				}
			};
		function removeFavourite(idToRemove){
			var newArrayOfIds = idOfFavourites.filter(
				item => item != idToRemove
				);
			idOfFavourites = newArrayOfIds;
			data.dishes[idToRemove].dishFav = 0;
		}
		$(document).on('pagecontainerbeforehide', 'body', function(event, ui) {
			if(ui.nextPage.attr('id') == "favourites"){
				$(".favItem").remove(); //remove the contents of the favourites list
				getFavourites();
				$(".favRemoveBtn").on('vclick', function(){
					removeFavourite($(this).closest(".favItem").attr("dishid"));
					$(this).closest(".favItem").remove();
				});
				$(".favCartBtn").on('vclick', function(){
					alert("Add to basket clicked");
				});
			}
		});		    
		$().ready(function(){
			$("#favourites").on("beforeshow", "body", function(event, ui) {
				alert("page before show called");// body...
			});
		});
	</script>
</body>
</html>
